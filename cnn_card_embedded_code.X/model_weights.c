#include "tensor.h"

/* 99th percentile of activations per layer
 * copied from cnn/train.ipynb
 */

const float conv0_activation_99per = 3.8983070850372314;
const float conv1_activation_99per = 5.799907207489014;
const float conv2_activation_99per = 6.455592155456543;

/* weight tensor data (definitions below)
 * (copied from cnn/train.ipynb)
 */

const float conv0_kernel_data[] = {
    6.425905e-01, 9.7541344e-01, 1.3965913e+00, -1.7676526e+00, 1.5048765e+00,
    7.247449e-01, 6.0712296e-01, 2.899096e-01, -1.3776002e+00, 3.041612e-01,
    1.4327172e+00, -5.3541064e-01, 1.3088208e+00, -1.8065302e+00, 1.1330576e+00,
    1.0078372e+00,
};

const float conv0_bias_data[] = {
    -5.4280776e-01, 7.773251e-01, -6.405903e-02, 7.611706e-01,
};

const float conv1_kernel_data[] = {
    -4.984483e-01, -4.8847172e-02, 3.7930003e-01, -4.82578e-01, 7.3634666e-01,
    2.4805817e-01, -4.0393016e-01, 7.766988e-01, 6.0854626e-01, -2.2769589e-02,
    -6.5343374e-01, -3.594065e-01, 6.2507963e-01, 1.7152704e-01, 2.606584e-01,
    6.852802e-02, 5.1834553e-01, -2.2862972e-01, -7.788347e-01, -3.9934143e-01,
    -5.7577003e-02, 5.288225e-01, 4.0383205e-01, 2.2803736e-01, -5.29878e-01,
    5.264101e-01, 8.182197e-01, -2.0285304e-01, -2.3091641e-01, -1.3508986e-01,
    -3.6642972e-01, 6.4859605e-01, -8.239043e-01, -6.26141e-01, -3.2304397e-01,
    9.303899e-02, 2.9367653e-01, 5.8737737e-01, 5.174812e-01, -8.31325e-01,
    3.2885727e-01, 4.9191558e-01, 1.4812052e-01, 5.602491e-01, -2.519057e-01,
    -6.384696e-01, -1.411592e-01, 8.832944e-02, -2.5376382e-01, -7.881377e-01,
    3.6555356e-01, 1.3475962e-01, -3.110899e-01, 5.047624e-01, -4.442756e-02,
    -3.3194974e-01, -4.8961584e-02, 3.428e-01, -1.11991785e-01, -2.7668744e-01,
    -7.852907e-01, -4.216264e-02, 2.1235433e-01, 8.6580324e-01, 1.8595468e-01,
    6.933603e-01, 2.4910161e-01, 7.476011e-01, -8.312345e-02, 1.514425e-01,
    -1.4560959e-01, -9.039143e-02, -1.8984197e-01, 4.167538e-01, 1.2577552e-01,
    -6.7143947e-01, -5.428908e-01, -3.4672424e-01, 6.3443667e-01, -1.7642163e-01,
    7.696325e-01, -1.01754464e-01, -3.7344128e-01, 2.0638238e-01, 9.632473e-01,
    -2.96629e-01, 3.5946545e-01, 4.5977142e-01, 1.2057326e-01, -2.0635896e-03,
    8.027489e-01, 2.111286e-02, -2.855503e-01, -1.3850655e-01, -5.151468e-01,
    7.840185e-02, 2.3916511e-01, 6.97286e-02, -1.08909264e-01, -4.642573e-01,
    -1.2095189e-01, 8.151304e-01, 2.5282642e-01, -4.5922136e-01, -3.9673108e-01,
    9.420066e-01, -5.793281e-02, 8.707696e-01, 2.0364597e-01, -3.155595e-01,
    5.988584e-02, 3.719758e-01, 3.7169725e-01, 2.3453376e-01, 1.10172756e-01,
    -3.2184547e-01, 6.038896e-01, 2.242445e-01, -4.1128522e-01, -6.257912e-01,
    -1.4831157e-01, 2.948746e-01, 4.9409312e-01, 3.6384243e-01, -1.0375192e-01,
    1.7784657e-02, 5.594536e-01, 3.3879673e-01,
};

const float conv1_bias_data[] = {
    -1.082098e-01, 4.2104775e-01, 2.3873918e-01, 3.7951005e-01, -5.8562126e-02,
    -1.7737073e-01, 1.4255933e-01, 2.5355417e-01,
};

const float conv2_kernel_data[] = {
    -1.6579282e-01, 3.314457e-01, -2.647318e-01, 2.274429e-01, -5.1037688e-02,
    2.8734457e-01, 2.6026616e-01, -6.152308e-02, 4.3191365e-03, 3.868803e-01,
    -3.537427e-02, 1.2368009e-01, -9.947861e-02, 4.2623523e-01, 1.005181e-02,
    -3.6945286e-01, 1.9057836e-01, -5.377119e-01, -1.1473059e-01, 2.5160125e-01,
    -1.18989445e-01, -5.749696e-01, -1.2163349e-01, -4.986102e-01, -2.0452723e-01,
    -1.7988095e-02, 1.4973096e-02, 6.989171e-03, 1.6021405e-01, -8.103328e-02,
    -1.4206725e-01, 7.0601374e-02, -1.6762787e-01, 1.7341891e-01, 1.5774e-02,
    1.9346878e-02, 5.8605973e-02, 2.5075144e-01, 4.175998e-01, 3.1754363e-01,
    -4.175045e-02, 2.706659e-01, 4.9393006e-02, 1.3899477e-01, -5.7464504e-01,
    3.160013e-01, 3.876169e-01, -3.5862517e-01, -1.4200218e-01, 1.2389062e-01,
    1.6393441e-01, -4.681362e-03, -2.0364013e-02, -1.2088166e-01, 1.0250136e-01,
    1.5454946e-01, -4.0041536e-02, 1.337831e-01, -1.5493071e-01, -9.910205e-02,
    -2.6639268e-01, 1.304206e-01, 5.9586936e-01, -1.6069262e-01, 3.3822682e-01,
    -1.06288284e-01, -1.8578112e-01, -1.9626254e-01, 3.3192244e-01, 5.6331925e-02,
    -7.019535e-03, -1.6911311e-01, -1.6033465e-01, 1.1405576e-01, 1.3231336e-01,
    3.8343573e-01, 3.4822047e-01, 2.3555093e-01, 7.623864e-01, 1.981618e-01,
    1.146173e-01, 1.8515992e-01, 2.1199748e-01, 2.1438254e-02, -2.8453138e-01,
    8.074179e-02, 2.8344047e-01, 2.8916666e-01, 1.1146685e-01, 1.6566572e-01,
    1.5367338e-01, -6.2266782e-02, 2.3780425e-01, 2.7545696e-02, -1.2226952e-01,
    -1.7232623e-02, -5.3322935e-01, 2.3593761e-02, 9.379391e-02, -5.9020404e-02,
    -2.1404944e-01, 1.0091396e-01, 2.6133507e-03, -2.3364495e-02, -1.7730112e-01,
    2.014705e-02, 1.372806e-01, 9.188418e-04, -2.3793162e-01, 3.3409664e-01,
    3.3295217e-01, 4.1675713e-02, 2.2516271e-01, 1.00453034e-01, 1.8531789e-01,
    6.2860884e-02, -2.0603742e-01, -1.8329246e-01, -1.5970217e-01, 6.428896e-02,
    1.551885e-01, 1.2599698e-01, -1.8802486e-01, 1.7931448e-01, -2.6057664e-02,
    -4.5710853e-01, -1.9235827e-01, -6.4035125e-02, 1.0384139e-01, -2.4951491e-01,
    -2.3111916e-01, -3.5507774e-01, -3.9140496e-01, 2.3642454e-01, -2.5958885e-02,
    -1.5522538e-01, -5.362453e-01, 3.8811126e-01, 3.420845e-02, -2.1665566e-01,
    -3.6328602e-01, 2.9104102e-01, -1.5839058e-01, -4.8406544e-01, -7.4500196e-02,
    -6.550351e-01, -1.3396259e-01, -3.4977764e-01, -4.4969186e-01, -3.7274832e-01,
    -1.737219e-02, 4.421099e-02, -9.231897e-02, -3.6284262e-01, 1.9930206e-01,
    -3.5084105e-01, -8.278355e-02, -3.0233675e-01, -6.380012e-02, -3.3092082e-01,
    -9.496023e-02, -1.8220596e-02, -8.834355e-02, -9.950886e-02, -1.846049e-01,
    1.7615983e-01, 2.1238452e-01, 1.00785494e-01, -5.362768e-02, -2.52473e-01,
    3.8649015e-02, 8.433069e-02, -5.8123565e-01, 2.522566e-01, 6.961334e-02,
    -2.9820898e-01, -2.2998324e-02, 3.365614e-01, 2.327698e-01, -1.1337085e-01,
    7.103252e-02, -4.9211073e-01, -2.607767e-01, -9.744836e-02, -1.409547e-01,
    5.201818e-02, 3.3066568e-01, 3.268594e-01, -3.963461e-02, 5.276892e-02,
    4.8471072e-01, -1.5732409e-01, 1.4778647e-01, -5.3468827e-02, 1.2117706e-01,
    -5.866163e-02, 1.7355572e-02, -8.070405e-02, -3.5590723e-02, 9.280412e-02,
    2.4153419e-01, -1.2684509e-02, -1.5841475e-02, 2.5610483e-01, 6.340753e-01,
    -5.9297763e-02, 3.45154e-01, 1.7768373e-01, -1.616265e-02, -3.2652536e-01,
    2.078365e-01, 9.3491465e-02, -1.18226804e-01, -2.1678106e-01, 2.7069157e-01,
    1.0519637e-01, 3.6878237e-01, 2.1531919e-01, -2.3681965e-01, 1.7189544e-01,
    5.024027e-01, 3.6430854e-01, 2.3813267e-01, -8.598915e-02, 5.1786624e-02,
    2.7892047e-01, 7.3700786e-02, -1.143224e-02, -1.2907545e-01, 2.4258496e-02,
    -1.6346328e-01, -1.2385854e-01, -2.5381783e-02, -3.2827836e-01, -1.9316107e-01,
    -3.9207555e-02, 6.610725e-02, 8.642581e-03, -1.0311891e-01, 2.1334046e-02,
    3.390601e-01, -1.0197741e-02, 3.829073e-01, 1.18002e-01, 3.7065092e-01,
    -2.6709187e-01, -3.4294245e-01, -2.6839978e-01, -1.2268939e-01, -2.4251871e-01,
    -1.0383293e-03, 3.525627e-01, 3.8700644e-02, -2.4477932e-01, -6.351073e-01,
    -2.7066284e-01, 8.911025e-02, 3.081354e-01, -4.3541896e-01, 1.368058e-01,
    -3.092836e-01, 1.071947e-01, -8.690341e-02, 6.121532e-01, -2.2205379e-02,
    -2.8150883e-01, -1.6068254e-01, 6.14921e-03, 5.6867e-02, 2.9503024e-01,
    1.4258328e-01, 1.3860506e-01, -1.3682461e-01, 1.6636084e-01, 2.8719482e-01,
    -6.896096e-02, -6.3423745e-02, -1.5586895e-01, 1.7404343e-01, -4.489673e-01,
    -1.585405e-01, -2.0313151e-01, 3.9424613e-02, -2.2764613e-01, -8.7893635e-02,
    -3.3513847e-01, -4.4382122e-01, -1.60605e-01, 1.414502e-01, -1.9720432e-01,
    -1.6497336e-01, 2.6342762e-01, 2.6976569e-02, 3.912072e-01, 7.644027e-02,
    2.0338154e-01, 9.539444e-03, -3.5717866e-01, -7.523897e-02, -2.0083036e-01,
    5.293369e-02, 8.1674695e-02, 2.9839405e-01, 4.969343e-01, -1.6751982e-01,
    1.2100774e-01, -2.4011541e-02, -1.6023122e-02, -8.888802e-02, -4.605174e-01,
    -3.4089804e-01, -7.672334e-02, 1.1304615e-01, 5.406415e-02, -2.3918335e-01,
    -3.9327538e-01, 3.1062236e-01, 4.42901e-01, -3.5229033e-01, -3.1487614e-01,
    2.7011245e-01, 1.1732465e-01, 3.8783047e-01, 1.7775951e-01, 6.488891e-02,
    3.5084274e-01, 6.975151e-01, 5.557026e-02, 1.7431329e-01, 1.0742646e-01,
    5.4644026e-02, 6.225451e-02, 5.731949e-02, -2.4015847e-01, 7.0362705e-01,
    1.756204e-01, -1.7471759e-02, 2.2852352e-01, 1.6339123e-01, -7.9053e-03,
    2.04612e-01, 2.886341e-02, -1.9780272e-01, 1.8969768e-01, 2.331273e-02,
    -5.362884e-01, -3.3568376e-01, -1.3487354e-01, 6.0168862e-02, 4.5309082e-01,
    2.7791706e-03, 1.920127e-01, -1.5040454e-01, -1.7764348e-01, -3.181245e-01,
    2.7919602e-01, 1.9390011e-01, 2.979049e-01, -2.6407376e-01, 1.4747037e-01,
    1.6932876e-01, 1.0982009e-01, -2.595745e-01, -3.4402543e-01, -1.7016706e-01,
    -9.074176e-02, 6.5498315e-02, 4.170144e-01, 1.4957698e-01, -2.8499463e-01,
    1.8492238e-01, -1.994338e-01, 1.36342e-01, -1.7789818e-01, -9.328251e-02,
    -1.9987029e-01, 3.4717205e-01, 1.2939446e-01, 2.5679126e-01, 3.9236566e-01,
    -2.0548346e-02, 1.6342267e-01, -3.43775e-01, 2.6258886e-01, -1.5345024e-01,
    7.5677363e-03, -1.357314e-01, -1.1394806e-01, 1.1636381e-01, 1.7910703e-01,
    -1.9274233e-01, 4.0318874e-01, 4.285527e-02, 4.3362743e-01, 1.9955148e-01,
    1.0277407e-01, 3.0605698e-01, 2.0581625e-01, -2.507472e-01, 1.1861823e-01,
    1.9991197e-01, 1.0193707e-01, -1.914294e-02, -2.0087363e-01, -2.0230542e-01,
    5.7153385e-02, 2.181897e-01, 2.7477767e-02, 4.967748e-02, -1.5838197e-01,
    -1.0100958e-01, -5.3132e-01, -3.3176637e-01, -5.053882e-01, -2.0791095e-01,
    -4.985479e-01, 2.6467183e-01, 8.985481e-02, 2.9422173e-01, 2.7304867e-01,
    3.5034806e-01, 1.0479241e-01, -3.6948077e-02, 1.1936239e-01, -4.0922967e-01,
    -2.856315e-01, -1.1152329e-02, -2.4927409e-01, 4.431221e-01, -2.3930639e-01,
    -1.2241337e-01, 3.4680864e-01, -1.00488625e-01, -1.20645165e-01, 2.3004712e-01,
    -3.5706416e-01, 8.180525e-02, -5.0333005e-01, -3.6588326e-02, -4.24294e-01,
    2.595032e-01, 2.530133e-01, 8.0053635e-02, -1.1201793e-02, -8.064663e-02,
    2.1016143e-01, 2.0230418e-02, -2.2886045e-01, 3.6242597e-03, 5.8388036e-02,
    4.8011723e-01, -8.4782e-02, 1.1527666e-01, 3.3184138e-01, 3.2726645e-01,
    1.6344109e-01, 4.6219435e-02, 8.01757e-02, -2.240086e-01, -7.247682e-04,
    2.4924478e-01, -1.5794176e-01, 1.04409754e-01, 1.9820029e-01, 1.4619866e-01,
    6.1875665e-01, 1.8946977e-01, 9.064421e-02, 2.569556e-01, -1.20254725e-01,
    -1.5010883e-01, -1.693618e-01, -1.0245983e-02, -7.8040704e-02, 2.45472e-04,
    4.273177e-01, 2.5605944e-01, 2.2038773e-01, -6.275617e-02, -8.1212536e-02,
    -3.0329534e-01, -1.2587693e-01, 9.533825e-02, -1.644635e-01, 1.8593998e-01,
    2.4069206e-01, -1.6304047e-01, 2.8189534e-01, -6.0497604e-02, -2.2759137e-01,
    2.6164037e-01, -5.1824504e-01, -2.9185823e-01, -2.1337152e-01, 1.6228197e-02,
    8.8678025e-02, -1.7646548e-01, -1.6245629e-01, -3.1620435e-02, 1.871568e-01,
    -5.7847388e-02, -1.7905997e-01, -1.0175326e-01, -5.2950495e-01, 3.9209953e-01,
    1.6650969e-01, -3.52616e-01, 3.6992183e-01, 8.419007e-02, 4.936019e-01,
    -4.4279754e-01, 1.9527978e-01,
};

const float conv2_bias_data[] = {
    -1.9329569e-01, -1.6699979e-01, -7.247025e-03, -7.0650816e-02, -3.1470556e-02,
    -1.1475146e-01, 3.697316e-02, 1.4575435e-01, -6.602414e-02, -1.4764068e-01,
    2.1613436e-02, -7.6171625e-03, -4.910724e-02, -2.1708958e-01, 2.832911e-01,
    -3.583509e-01,
};

const float dense_kernel_data[] = {
    3.5488138e-01, -3.1582853e-01, -1.4117907e-01, -1.0696316e+00, -1.7527697e+00,
    -7.237004e-01, -3.4012076e-01, -5.9612167e-01, -3.3725396e-01, -2.2777793e+00,
    1.6913373e+00, -1.2393929e-01, -7.8385574e-01, -1.376475e-01, 2.2685685e+00,
    2.191815e+00, 5.821514e-01, -1.4276528e+00, 1.9613502e+00, 1.242615e+00,
    -1.8258322e+00, 1.594884e+00, -1.8562188e+00, -2.8211373e-01, 7.181632e-02,
    -6.1093324e-01, -1.7317193e+00, 2.5102777e+00, -1.6518731e-01, -1.3517337e+00,
    -1.7132875e-01, -1.6225023e+00, 9.5681256e-01, -1.6300222e+00, -9.5684904e-01,
    -1.187547e+00, -1.3556433e+00, 6.114503e-01, 3.7076987e-02, 1.6080065e+00,
    1.6916512e+00, -1.4489942e+00, 1.100945e+00, -1.0284277e+00, 7.7180666e-01,
    -4.9033982e-01, -1.2351002e+00, 1.9808751e+00, 1.0601794e+00, -4.5662802e-01,
    -4.865822e-02, 1.386055e+00, 4.0179947e-01, -1.2613064e+00, 1.3263035e+00,
    -1.0166608e+00, -1.2935249e+00, 1.3762524e+00, -1.8275495e+00, -8.098866e-01,
    1.4304508e+00, -1.1702694e+00, 3.8555863e-01, -9.2042977e-01, 6.973281e-01,
    2.0608869e+00, -1.7174233e-01, -2.2563617e+00, 3.442565e+00, -1.6600956e+00,
    -5.842879e-01, 1.3269225e-01, 1.5431386e+00, -8.04582e-01, -8.561825e-02,
    -9.974681e-03, -1.7865726e+00, 1.7411724e+00, -5.9428126e-01, 1.1434467e+00,
    -1.4884508e+00, 1.8241984e+00, 6.99821e-01, 9.6329457e-01, -2.2970371e+00,
    4.9747062e-01, 1.5975451e+00, -5.9820294e-01, -1.4592981e+00, 2.373525e+00,
    8.225556e-01, -9.804059e-02, -7.9334867e-01, -5.262273e-01, -6.069681e-01,
    -1.5943501e+00, -8.3040655e-01, 3.1808802e-01, -1.2938453e-01, 8.6064523e-01,
    6.4486617e-01, 1.4232988e+00, -2.1669728e-01, 9.485915e-01, 2.5663832e-01,
    -3.7212157e-01, 4.0389112e-01, -1.9818672e+00, -1.1888213e+00, -1.497692e-01,
    6.526883e-01, -2.3118403e+00, 4.0534896e-01, 1.6986848e-01, 1.0613499e+00,
    -2.274171e+00, 1.0950952e-01, -1.8851547e-02, -7.808207e-01, -2.5479195e+00,
    9.697832e-01, -8.3121485e-01, 1.212268e+00, -9.87266e-01, 1.5337702e+00,
    -1.3302177e-01, -5.602096e-01, 2.8568137e+00, -1.3923304e+00, -1.3558983e+00,
    -9.186089e-01, -2.8299436e-02, 8.435234e-01, 7.550959e-02, 1.5198041e-01,
    7.169753e-01, -6.0877156e-01, 5.343068e-01, -1.4958209e+00, -1.4346102e-02,
    6.361309e-01, -4.063859e-01, 1.2128117e+00, -1.5309963e+00, -3.2886663e-01,
    -1.7458285e+00, -5.59102e-01, 3.5249332e-01, -7.370757e-01, -1.0642827e+00,
    1.0966437e+00, -3.7089205e-01, -5.0169337e-01, 4.84968e-01, -4.671661e-03,
    2.0958045e+00, 1.321445e-01, 1.6186578e+00, -7.815421e-01, -1.20745935e-01,
};

const float dense_bias_data[] = {
    4.5377952e-01, 3.342056e-01, 1.281946e-01, 1.5441601e-01, 2.589751e-01,
    6.062427e-01, 6.319981e-01, -2.0237873e+00, -4.2561367e-01, -7.843375e-01,
};


/* Weight tensor definitions */

const struct float_4tensor conv0_kernel = {
    .data=(float*) conv0_kernel_data,
    .s0=2, // rows
    .s1=2, // cols
    .s2=1, // input channels
    .s3=4  // filters
};


const struct float_4tensor conv0_bias = {
    .data=(float*) conv0_bias_data,
    .s0=4, // channels
    .s1=1,
    .s2=1,
    .s3=1 
};

const struct float_4tensor conv1_kernel = {
    .data=(float*) conv1_kernel_data,
    .s0=2, // rows
    .s1=2, // cols
    .s2=4, // input channels
    .s3=8  // filters
};

const struct float_4tensor conv1_bias = {
    .data=(float*) conv1_bias_data,
    .s0=8, // channels
    .s1=1,
    .s2=1,
    .s3=1 
};

const struct float_4tensor conv2_kernel = {
    .data=(float*) conv2_kernel_data,
    .s0=2, // rows
    .s1=2, // cols
    .s2=8, // input channels
    .s3=16  // filters
};

const struct float_4tensor conv2_bias = {
    .data=(float*) conv2_bias_data,
    .s0=16, // channels
    .s1=1,
    .s2=1,
    .s3=1 
};

const struct float_4tensor dense_kernel = {
    .data=(float*) dense_kernel_data,
    .s0=10, // input channels
    .s1=16, // units
    .s2=1,
    .s3=1
};

const struct float_4tensor dense_bias = {
    .data=(float*) dense_bias_data,
    .s0=10, // channels
    .s1=1,
    .s2=1,
    .s3=1 
};